<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

    <title>Config Creator</title>
  </head>
  <body>
    <div class="container" id="container" style="padding-bottom: 75px;">
      <h1 style="padding-top:20px;padding-bottom:20px;">Configuration Creator</h1>
      <form id="config-form">
        <div class="row">

          <div class="col-xs-12 col-md-6 col-lg-4">
            <div class="card mb-3">
              <div class="card-body">
                <h5 class="card-title">Name</h5>
                <p class="card-text">
                  <p>The name of the configuration file should match the name of the context in Tasker. So if you have a 'home' context in Tasker, your configuration file should be named 'home' as well.</p>
                  <input type="text" autocapitalize="none" class="form-control" name="nameInput" id="nameInput" placeholder="Enter the context name">
                </p>
              </div>
            </div>
          </div>
          
          <div class="col-xs-12 col-md-6 col-lg-4">
            <div class="card mb-3">
              <div class="card-body">
                <h5 class="card-title">Type</h5>
                <p class="card-text">
                  <p>Primary or secondary. Only one primary context can be active at a time while multiple secondary contexts can be active simultaneously. Primary contexts are often places, while secondary contexts are modifiers on top of the primary context.</p>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="typeRadios" id="typeRadios1" value="1" checked>
                    <label class="form-check-label" for="typeRadios1">Primary</label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="typeRadios" id="typeRadios2" value="2">
                    <label class="form-check-label" for="typeRadios2">Secondary</label>
                  </div>
                </p>
              </div>
            </div>
          </div>

          <div class="col-xs-12 col-md-6 col-lg-4">
            <div class="card mb-3">
              <div class="card-body">
                <h5 class="card-title">Priority</h5>
                <p class="card-text">
                  <p>The highest priority primary context will be active and any secondary context with equal or higher priority will be active. Use this value to make certain contexts take precedence over other contexts.</p>
                  <input type="number" class="form-control" name="priorityInput" id="priorityInput" placeholder="Enter a number 1 to 100">
                </p>
              </div>
            </div>
          </div>

          <div class="col-xs-12 col-md-6 col-lg-4">
            <div class="card mb-3">
              <div class="card-body">
                <h5 class="card-title">Volumes</h5>
                <p class="card-text">
                  <p>Set the notification and media volumes. The number of volume steps depends on the device and manufacturer.</p>
                  <p class="form-check">
                    <input class="form-check-input" type="checkbox" value="1" name="notifVolCheck1" id="notifVolCheck1">
                    <label class="form-check-label" for="notifVolCheck1">Change notification volume</label>
                    <input type="number" class="form-control" name="notifVolInput" id="notifVolInput" placeholder="Enter a number 0 or higher" disabled>
                  </p>
                  <p class="form-check">
                    <input class="form-check-input" type="checkbox" value="1" name="mediaVolCheck1" id="mediaVolCheck1">
                    <label class="form-check-label" for="mediaVolCheck1">Change media volume</label>
                    <input type="number" class="form-control" name="mediaVolInput" id="mediaVolInput" placeholder="Enter a number 0 or higher" disabled>
                    <p style="padding-left: 20px;">Allow manual media volume changes to persist while context is active. For example, select yes for a headphones context to prevent manual volume changes from being reset if you leave your house.</p>
                    <p style="padding-left: 20px;" class="font-italic">Note: only select No if you want to override this option for lower priority contexts.</p>
                    <div style="padding-left: 20px;" class="form-check-inline">
                      <input class="form-check-input" type="radio" name="mediaVolOverrideRadioOptions" id="mediaVolOverrideRadio1" value="yes" disabled>
                      <label class="form-check-label" for="mediaVolOverrideRadio1">Yes</label>
                    </div>
                    <div class="form-check-inline">
                      <input class="form-check-input" type="radio" name="mediaVolOverrideRadioOptions" id="mediaVolOverrideRadio2" value="no" disabled>
                      <label class="form-check-label" for="mediaVolOverrideRadio2">No</label>
                    </div>
                    <div class="form-check-inline">
                      <input class="form-check-input" type="radio" name="mediaVolOverrideRadioOptions" id="mediaVolOverrideRadio3" value="null" disabled checked>
                      <label class="form-check-label" for="mediaVolOverrideRadio3">Null</label>
                    </div>
                  </p>
                </p>
              </div>
            </div>
          </div>

          <div class="col-xs-12 col-md-6 col-lg-4">
            <div class="card mb-3">
              <div class="card-body">
                <h5 class="card-title">Display</h5>
                <p class="card-text">
                  <p>Change display settings.</p>
                  <p class="form-check">
                    <input class="form-check-input" type="checkbox" value="1" name="rotationCheck1" id="rotationCheck1">
                    <label class="form-check-label" for="rotationCheck1">Turn display rotation on/off</label>
                    <fieldset id="rotationFieldset" style="padding-left:30px;" disabled>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="rotationRadio" id="rotationRadio1" value="true" checked>
                        <label class="form-check-label" for="rotationRadio1">On</label>
                      </div>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="rotationRadio" id="rotationRadio2" value="false">
                        <label class="form-check-label" for="rotationRadio2">Off</label>
                      </div>
                    </fieldset>
                  </p>
                  <p class="form-check">
                    <input class="form-check-input" type="checkbox" value="1" name="timeoutCheck1" id="timeoutCheck1">
                    <label class="form-check-label" for="timeoutCheck1">Change display timeout (minutes)</label>
                    <input type="number" class="form-control" name="timeoutInput" id="timeoutInput" placeholder="Enter a number 1 or higher" disabled>
                  </p>
                  <p class="form-check">
                    <input class="form-check-input" type="checkbox" value="1" name="brightnessCheck1" id="brightnessCheck1">
                    <label class="form-check-label" for="brightnessCheck1">Change display brightness</label>
                    <input type="text" autocapitalize="none" class="form-control" name="brightnessInput" id="brightnessInput" placeholder="Enter auto or a number 0 to 255" disabled>
                  </p>
                  <p class="form-check">
                    <input class="form-check-input" type="checkbox" value="1" name="extraDimCheck1" id="extraDimCheck1">
                    <label class="form-check-label" for="extraDimCheck1">Turn extra dim on/off</label>
                    <fieldset id="extraDimFieldset" style="padding-left:30px;" disabled>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="extraDimRadio" id="extraDimRadio1" value="true" checked>
                        <label class="form-check-label" for="extraDimRadio1">On</label>
                      </div>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="extraDimRadio" id="extraDimRadio2" value="false">
                        <label class="form-check-label" for="extraDimRadio2">Off</label>
                      </div>
                    </fieldset>
                  </p>
                  <p class="form-check">
                    <input class="form-check-input" type="checkbox" value="1" name="nightLightCheck1" id="nightLightCheck1">
                    <label class="form-check-label" for="nightLightCheck1">Turn Night Light on/off (Pixel Only)</label>
                    <fieldset id="nightLightFieldset" style="padding-left:30px;" disabled>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="nightLightRadio" id="nightLightRadio1" value="true" checked>
                        <label class="form-check-label" for="nightLightRadio1">On</label>
                      </div>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="nightLightRadio" id="nightLightRadio2" value="false">
                        <label class="form-check-label" for="nightLightRadio2">Off</label>
                      </div>
                    </fieldset>
                  </p>
                  <p class="form-check">
                    <input class="form-check-input" type="checkbox" value="1" name="darkModeCheck1" id="darkModeCheck1">
                    <label class="form-check-label" for="darkModeCheck1">Turn dark mode on/off</label>
                    <fieldset id="darkModeFieldset" style="padding-left:30px;" disabled>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="darkModeRadio" id="darkModeRadio1" value="true" checked>
                        <label class="form-check-label" for="darkModeRadio1">On</label>
                      </div>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="darkModeRadio" id="darkModeRadio2" value="false">
                        <label class="form-check-label" for="darkModeRadio2">Off</label>
                      </div>
                    </fieldset>
                  </p>
                  <p class="form-check">
                    <input class="form-check-input" type="checkbox" value="1" name="grayscaleModeCheck1" id="grayscaleModeCheck1">
                    <label class="form-check-label" for="grayscaleModeCheck1">Turn grayscale mode on/off</label>
                    <fieldset id="grayscaleModeFieldset" style="padding-left:30px;" disabled>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="grayscaleModeRadio" id="grayscaleModeRadio1" value="true" checked>
                        <label class="form-check-label" for="grayscaleModeRadio1">On</label>
                      </div>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="grayscaleModeRadio" id="grayscaleModeRadio2" value="false">
                        <label class="form-check-label" for="grayscaleModeRadio2">Off</label>
                      </div>
                    </fieldset>
                  </p>
                  <p class="form-check">
                    <input class="form-check-input" type="checkbox" value="1" name="immersiveCheck1" id="immersiveCheck1">
                    <label class="form-check-label" for="immersiveCheck1">Change immersive mode</label>
                    <fieldset id="immersiveFieldset" disabled>
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="immersiveRadios" id="immersiveRadios1" value="off" checked>
                        <label class="form-check-label" for="immersiveRadios1">Immersive mode off</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="immersiveRadios" id="immersiveRadios2" value="status">
                        <label class="form-check-label" for="immersiveRadios2">Status bar only</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="immersiveRadios" id="immersiveRadios3" value="navigation">
                        <label class="form-check-label" for="immersiveRadios3">Navigation bar only</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="immersiveRadios" id="immersiveRadios4" value="both">
                        <label class="form-check-label" for="immersiveRadios4">Full immersive mode</label>
                      </div>
                    </fieldset>
                  </p>
                </p>
              </div>
            </div>
          </div>

          <div class="col-xs-12 col-md-6 col-lg-4">
            <div class="card mb-3">
              <div class="card-body">
                <h5 class="card-title">Radios</h5>
                <p class="card-text">
                  <p>Turn on/off device radios.</p>
                  <p class="form-check">
                    <input class="form-check-input" type="checkbox" value="1" name="wifiCheck1" id="wifiCheck1">
                    <label class="form-check-label" for="wifiCheck1">Turn Wifi on/off</label>
                    <fieldset id="wifiFieldset" style="padding-left:30px;" disabled>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="wifiRadio" id="wifiRadio1" value="true" checked>
                        <label class="form-check-label" for="wifiRadio1">On</label>
                      </div>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="wifiRadio" id="wifiRadio2" value="false">
                        <label class="form-check-label" for="wifiRadio2">Off</label>
                      </div>
                    </fieldset>
                  </p>
                  <p class="form-check">
                    <input class="form-check-input" type="checkbox" value="1" name="bluetoothCheck1" id="bluetoothCheck1">
                    <label class="form-check-label" for="bluetoothCheck1">Turn Bluetooth on/off</label>
                    <fieldset id="bluetoothFieldset" style="padding-left:30px;" disabled>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="bluetoothRadio" id="bluetoothRadio1" value="true" checked>
                        <label class="form-check-label" for="bluetoothRadio1">On</label>
                      </div>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="bluetoothRadio" id="bluetoothRadio2" value="false">
                        <label class="form-check-label" for="bluetoothRadio2">Off</label>
                      </div>
                    </fieldset>
                  </p>
                  <p class="form-check">
                    <input class="form-check-input" type="checkbox" value="1" name="airplaneCheck1" id="airplaneCheck1">
                    <label class="form-check-label" for="airplaneCheck1">Turn Airplane Mode on/off</label>
                    <fieldset id="airplaneFieldset" style="padding-left:30px;" disabled>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="airplaneRadio" id="airplaneRadio1" value="true" checked>
                        <label class="form-check-label" for="airplaneRadio1">On</label>
                      </div>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="airplaneRadio" id="airplaneRadio2" value="false">
                        <label class="form-check-label" for="airplaneRadio2">Off</label>
                      </div>
                    </fieldset>
                  </p>
                </p>
              </div>
            </div>
          </div>

          <div class="col-xs-12 col-md-6 col-lg-4">
            <div class="card mb-3">
              <div class="card-body">
                <h5 class="card-title">Do Not Disturb</h5>
                <p class="card-text">
                  <p>Set the do not disturb mode.</p>
                  <p class="form-check">
                    <input class="form-check-input" type="checkbox" value="1" name="dndCheck1" id="dndCheck1">
                    <label class="form-check-label" for="dndCheck1">Change DND mode</label>
                  </p>
                  <fieldset id="dndFieldset" disabled>
                    <div class="form-check">
                      <input class="form-check-input" type="radio" name="dndRadios" id="dndRadios1" value="all" checked>
                      <label class="form-check-label" for="dndRadios1">All - Receive all notifications</label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="radio" name="dndRadios" id="dndRadios2" value="priority">
                      <label class="form-check-label" for="dndRadios2">Priority - Priority-only notifications</label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="radio" name="dndRadios" id="dndRadios3" value="alarms">
                      <label class="form-check-label" for="dndRadios3">Alarms - alarms only</label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="radio" name="dndRadios" id="dndRadios4" value="none">
                      <label class="form-check-label" for="dndRadios4">None - complete silence</label>
                    </div>
                  </fieldset>
                </p>
              </div>
            </div>
          </div>

          <div class="col-xs-12 col-md-6 col-lg-4">
            <div class="card mb-3">
              <div class="card-body">
                <h5 class="card-title">Location</h5>
                <p class="card-text">
                  <p>Set the location mode.</p>
                  <p class="font-italic">Note: requires you to grant Tasker WRITE_SECURE_SETTINGS permission</p>
                  <p class="form-check">
                    <input class="form-check-input" type="checkbox" value="1" name="locationCheck1" id="locationCheck1">
                    <label class="form-check-label" for="locationCheck1">Change location mode</label>
                  </p>
                  <fieldset id="locationFieldset" disabled>
                    <div class="form-check">
                      <input class="form-check-input" type="radio" name="locationRadios" id="locationRadios1" value="off" checked>
                      <label class="form-check-label" for="locationRadios1">Off - location services off</label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="radio" name="locationRadios" id="locationRadios2" value="accuracy">
                      <label class="form-check-label" for="locationRadios2">Accuracy - high accuracy mode</label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="radio" name="locationRadios" id="locationRadios3" value="battery">
                      <label class="form-check-label" for="locationRadios3">Battery - battery saver mode</label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="radio" name="locationRadios" id="locationRadios4" value="device">
                      <label class="form-check-label" for="locationRadios4">Device - device only mode</label>
                    </div>
                  </fieldset>
                </p>
              </div>
            </div>
          </div>

          <div class="col-xs-12 col-md-6 col-lg-4">
            <div class="card mb-3">
              <div class="card-body">
                <h5 class="card-title">Other</h5>
                <p class="card-text">
                  <p>Turn on/off other settings.</p>
                  <p class="font-italic">Note: requires you to grant Tasker WRITE_SECURE_SETTINGS permission</p>
                  <p class="form-check">
                    <input class="form-check-input" type="checkbox" value="1" name="hapticCheck1" id="hapticCheck1">
                    <label class="form-check-label" for="hapticCheck1">Turn haptic feedback on/off</label>
                    <fieldset id="hapticFieldset" style="padding-left:30px;" disabled>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="hapticRadio" id="hapticRadio1" value="true" checked>
                        <label class="form-check-label" for="hapticRadio1">On</label>
                      </div>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="hapticRadio" id="hapticRadio2" value="false">
                        <label class="form-check-label" for="hapticRadio2">Off</label>
                      </div>
                    </fieldset>
                  </p>
                  <p class="form-check">
                    <input class="form-check-input" type="checkbox" value="1" name="batteryCheck1" id="batteryCheck1">
                    <label class="form-check-label" for="batteryCheck1">Turn battery saver on/off</label>
                    <fieldset id="batteryFieldset" style="padding-left:30px;" disabled>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="batteryRadio" id="batteryRadio1" value="true" checked>
                        <label class="form-check-label" for="batteryRadio1">On</label>
                      </div>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="batteryRadio" id="batteryRadio2" value="false">
                        <label class="form-check-label" for="batteryRadio2">Off</label>
                      </div>
                    </fieldset>
                  </p>
                </p>
              </div>
            </div>
          </div>

          <div class="col-xs-12 col-md-6 col-lg-4">
            <div class="card mb-3">
              <div class="card-body">
                <h5 class="card-title">Enter</h5>
                <p class="card-text">
                  <p>Enable/disable profiles and run tasks when the context becomes active.</p>
                  <p class="form-check">
                    <input class="form-check-input" type="checkbox" value="1" name="epeCheck1" id="epeCheck1">
                    <label class="form-check-label" for="epeCheck1">Enable profiles on enter</label>
                    <input type="text" autocapitalize="none" class="form-control" name="epeInput" id="epeInput" placeholder="ProfileName1,ProfileName2..." disabled>
                  </p>
                  <p class="form-check">
                    <input class="form-check-input" type="checkbox" value="1" name="epdCheck1" id="epdCheck1">
                    <label class="form-check-label" for="epdCheck1">Disable profiles on enter</label>
                    <input type="text" autocapitalize="none" class="form-control" name="epdInput" id="epdInput" placeholder="ProfileName1,ProfileName2..." disabled>
                  </p>
                  <p class="form-check">
                    <input class="form-check-input" type="checkbox" value="1" name="etCheck1" id="etCheck1">
                    <label class="form-check-label" for="etCheck1">Run tasks on enter</label>
                    <input type="text" autocapitalize="none" class="form-control" name="etInput" id="etInput" placeholder="Name1|Priority|Param1|Param2,Name2..." disabled>
                  </p>
                </p>
              </div>
            </div>
          </div>

          <div class="col-xs-12 col-md-6 col-lg-4">
            <div class="card mb-3">
              <div class="card-body">
                <h5 class="card-title">Exit</h5>
                <p class="card-text">
                  <p>Enable/disable profiles and run tasks when the context becomes inactive.</p>
                  <p class="form-check">
                    <input class="form-check-input" type="checkbox" value="1" name="xpeCheck1" id="xpeCheck1">
                    <label class="form-check-label" for="xpeCheck1">Enable profiles on exit</label>
                    <input type="text" autocapitalize="none" class="form-control" name="xpeInput" id="xpeInput" placeholder="ProfileName1,ProfileName2..." disabled>
                  </p>
                  <p class="form-check">
                    <input class="form-check-input" type="checkbox" value="1" name="xpdCheck1" id="xpdCheck1">
                    <label class="form-check-label" for="xpdCheck1">Disable profiles on exit</label>
                    <input type="text" autocapitalize="none" class="form-control" name="xpdInput" id="xpdInput" placeholder="ProfileName1,ProfileName2..." disabled>
                  </p>
                  <p class="form-check">
                    <input class="form-check-input" type="checkbox" value="1" name="xtCheck1" id="xtCheck1">
                    <label class="form-check-label" for="xtCheck1">Run tasks on exit</label>
                    <input type="text" autocapitalize="none" class="form-control" name="xtInput" id="xtInput" placeholder="Name1|Priority|Param1|Param2,Name2..." disabled>
                  </p>
                </p>
              </div>
            </div>
          </div>

        </div>

        <nav class="navbar fixed-bottom navbar-light bg-light">
          <div class="container">
            <button class="btn btn-primary" type="submit">Generate Config</button>
          </div>
        </nav>
      </form>

      <div class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" id="code-modal" aria-labelledby="myLargeModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">Generated Configuration</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <p><pre><code id="config-code"></code></pre></p>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              <!--<button type="button" class="btn btn-primary">Download</button>-->
              <a class="btn btn-primary" role="button" id="download-button">Download</a>
            </div>
          </div>
        </div>
      </div>

    </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <script>
      var GENERATED_CONFIG;
      var CONFIG_NAME;
      
      $("#notifVolCheck1").change(function() {
        if(this.checked) {
          $("#notifVolInput").prop("disabled", false);
          $("#notifVolInput").select();
        } else {
          $("#notifVolInput").prop("disabled", true);
        }
      });
      $("#mediaVolCheck1").change(function() {
        if(this.checked) {
          $("#mediaVolInput").prop("disabled", false);
          $("#mediaVolOverrideRadio1").prop("disabled", false);
          $("#mediaVolOverrideRadio2").prop("disabled", false);
          $("#mediaVolOverrideRadio3").prop("disabled", false);
          $("#mediaVolInput").select();
        } else {
          $("#mediaVolInput").prop("disabled", true);
          $("#mediaVolOverrideRadio1").prop("disabled", true);
          $("#mediaVolOverrideRadio2").prop("disabled", true);
          $("#mediaVolOverrideRadio3").prop("disabled", true);
        }
      });
      $("#dndCheck1").change(function() {
        if(this.checked) {
          $("#dndFieldset").prop("disabled", false);
        } else {
          $("#dndFieldset").prop("disabled", true);
        }
      });
      $("#locationCheck1").change(function() {
        if(this.checked) {
          $("#locationFieldset").prop("disabled", false);
        } else {
          $("#locationFieldset").prop("disabled", true);
        }
      });
      $("#wifiCheck1").change(function() {
        if(this.checked) {
          $("#wifiFieldset").prop("disabled", false);
        } else {
          $("#wifiFieldset").prop("disabled", true);
        }
      });
      $("#bluetoothCheck1").change(function() {
        if(this.checked) {
          $("#bluetoothFieldset").prop("disabled", false);
        } else {
          $("#bluetoothFieldset").prop("disabled", true);
        }
      });
      $("#airplaneCheck1").change(function() {
        if(this.checked) {
          $("#airplaneFieldset").prop("disabled", false);
        } else {
          $("#airplaneFieldset").prop("disabled", true);
        }
      });
      $("#rotationCheck1").change(function() {
        if(this.checked) {
          $("#rotationFieldset").prop("disabled", false);
        } else {
          $("#rotationFieldset").prop("disabled", true);
        }
      });
      $("#timeoutCheck1").change(function() {
        if(this.checked) {
          $("#timeoutInput").prop("disabled", false);
          $("#timeoutInput").select();
        } else {
          $("#timeoutInput").prop("disabled", true);
        }
      });
      $("#brightnessCheck1").change(function() {
        if(this.checked) {
          $("#brightnessInput").prop("disabled", false);
          $("#brightnessInput").select();
        } else {
          $("#brightnessInput").prop("disabled", true);
        }
      });
      $("#extraDimCheck1").change(function() {
        if (this.checked) {
          $("#extraDimFieldset").prop("disabled", false);
        } else {
          $("#extraDimFieldset").prop("disabled", true);
        }
      });
      $("#nightLightCheck1").change(function() {
        if (this.checked) {
          $("#nightLightFieldset").prop("disabled", false);
        } else {
          $("#nightLightFieldset").prop("disabled", true);
        }
      });
      $("#immersiveCheck1").change(function() {
        if(this.checked) {
          $("#immersiveFieldset").prop("disabled", false);
        } else {
          $("#immersiveFieldset").prop("disabled", true);
        }
      });
      $("#darkModeCheck1").change(function() {
        if(this.checked) {
          $("#darkModeFieldset").prop("disabled", false);
        } else {
          $("#darkModeFieldset").prop("disabled", true);
        }
      });
      $("#grayscaleModeCheck1").change(function() {
        if(this.checked) {
          $("#grayscaleModeFieldset").prop("disabled", false);
        } else {
          $("#grayscaleModeFieldset").prop("disabled", true);
        }
      });
      $("#hapticCheck1").change(function() {
        if(this.checked) {
          $("#hapticFieldset").prop("disabled", false);
        } else {
          $("#hapticFieldset").prop("disabled", true);
        }
      });
      $("#batteryCheck1").change(function() {
        if(this.checked) {
          $("#batteryFieldset").prop("disabled", false);
        } else {
          $("#batteryFieldset").prop("disabled", true);
        }
      });
      $("#epeCheck1").change(function() {
        if(this.checked) {
          $("#epeInput").prop("disabled", false);
          $("#epeInput").select();
        } else {
          $("#epeInput").prop("disabled", true);
        }
      });
      $("#epdCheck1").change(function() {
        if(this.checked) {
          $("#epdInput").prop("disabled", false);
          $("#epdInput").select();
        } else {
          $("#epdInput").prop("disabled", true);
        }
      });
      $("#etCheck1").change(function() {
        if(this.checked) {
          $("#etInput").prop("disabled", false);
          $("#etInput").select();
        } else {
          $("#etInput").prop("disabled", true);
        }
      });
      $("#xpeCheck1").change(function() {
        if(this.checked) {
          $("#xpeInput").prop("disabled", false);
          $("#xpeInput").select();
        } else {
          $("#xpeInput").prop("disabled", true);
        }
      });
      $("#xpdCheck1").change(function() {
        if(this.checked) {
          $("#xpdInput").prop("disabled", false);
          $("#xpdInput").select();
        } else {
          $("#xpdInput").prop("disabled", true);
        }
      });
      $("#xtCheck1").change(function() {
        if(this.checked) {
          $("#xtInput").prop("disabled", false);
          $("#xtInput").select();
        } else {
          $("#xtInput").prop("disabled", true);
        }
      });


      function processForm(e) {
        if (e.preventDefault) e.preventDefault();
        let formObj = $("#config-form :input").serializeArray();
        console.dir(formObj);
        let configObj = {};
        configObj.type = parseInt(formObj.find(o => { return (o.name === "typeRadios"); }).value);
        let priority = formObj.find(o => { return (o.name === "priorityInput"); }).value || 50;
        configObj.priority = parseInt(priority);
        let notifVolObj = formObj.find(o => { return (o.name === "notifVolInput"); });
        if (notifVolObj !== undefined && Number.isInteger(parseInt(notifVolObj.value))) configObj.volume_notification = parseInt(notifVolObj.value);
        let mediaVolObj = formObj.find(o => { return (o.name === "mediaVolInput"); });
        if (mediaVolObj !== undefined && Number.isInteger(parseInt(mediaVolObj.value))) configObj.volume_media = parseInt(mediaVolObj.value);
        let mediaVolOverride = formObj.find(o => { return (o.name === "mediaVolOverrideRadioOptions"); });
        if (mediaVolOverride !== undefined && mediaVolOverride.value !== "null") configObj.volume_media_override = (mediaVolOverride.value === "yes");
        let dndObj = formObj.find(o => { return (o.name === "dndRadios"); });
        if (dndObj !== undefined) configObj.dnd = dndObj.value;
        let locationObj = formObj.find(o => { return (o.name === "locationRadios"); });
        if (locationObj !== undefined) configObj.location = locationObj.value;
        let wifiObj = formObj.find(o => { return (o.name === "wifiRadio"); });
        if (wifiObj !== undefined) configObj.wifiOn = (wifiObj.value === "true" ? true : false);
        let bluetoothObj = formObj.find(o => { return (o.name === "bluetoothRadio"); });
        if (bluetoothObj !== undefined) configObj.bluetoothOn = (bluetoothObj.value === "true" ? true : false);
        let airplaneObj = formObj.find(o => { return (o.name === "airplaneRadio"); });
        if (airplaneObj !== undefined) configObj.airplaneModeOn = (airplaneObj.value === "true" ? true : false);
        let rotationObj = formObj.find(o => { return (o.name === "rotationRadio"); });
        if (rotationObj !== undefined) configObj.screenRotationOn = (rotationObj.value === "true" ? true : false);
        let timeoutObj = formObj.find(o => { return (o.name === "timeoutInput"); });
        if (timeoutObj !== undefined && Number.isInteger(parseInt(timeoutObj.value))) configObj.displayTimeout = parseInt(timeoutObj.value);
        let brightnessObj = formObj.find(o => { return (o.name === "brightnessInput"); });
        if (brightnessObj !== undefined && Number.isInteger(parseInt(brightnessObj.value))) configObj.displayBrightness = parseInt(brightnessObj.value);
        let nightLightObj = formObj.find(o => { return (o.name === "nightLightRadio"); });
        if (nightLightObj !== undefined) configObj.nightLightOn = (nightLightObj.value === "true" ? true : false);
        let extraDimObj = formObj.find(o => { return (o.name === "extraDimRadio"); });
        if (extraDimObj !== undefined) configObj.extraDimOn = (extraDimObj.value === "true" ? true : false);
        let grayscaleModeObj = formObj.find(o => { return (o.name === "grayscaleModeRadio"); });
        if (grayscaleModeObj !== undefined) configObj.grayscaleMode = (grayscaleModeObj.value === "true" ? true : false);
        let immersiveObj = formObj.find(o => { return (o.name === "immersiveRadios"); });
        if (immersiveObj !== undefined) configObj.immersiveMode = immersiveObj.value;
        let darkModeObj = formObj.find(o => { return (o.name === "darkModeRadio"); });
        if (darkModeObj !== undefined) configObj.darkMode = (darkModeObj.value === "true" ? true : false);
        let hapticObj = formObj.find(o => { return (o.name === "hapticRadio"); });
        if (hapticObj !== undefined) configObj.hapticFeedbackOn = (hapticObj.value === "true" ? true : false);
        let batteryObj = formObj.find(o => { return (o.name === "batteryRadio"); });
        if (batteryObj !== undefined) configObj.batterySaverOn = (batteryObj.value === "true" ? true : false);
        // TODO enter/exit profiles and tasks
        let epeObj = formObj.find(o => { return (o.name === "epeInput"); });
        if (epeObj !== undefined) {
          if (!configObj.enter) configObj.enter = {};
          configObj.enter.profilesToEnable = profileParser(epeObj.value);
        }
        let epdObj = formObj.find(o => { return (o.name === "epdInput"); });
        if (epdObj !== undefined) {
          if (!configObj.enter) configObj.enter = {};
          configObj.enter.profilesToDisable = profileParser(epdObj.value);
        }
        let etObj = formObj.find(o => { return (o.name === "etInput"); });
        if (etObj !== undefined) {
          if (!configObj.enter) configObj.enter = {};
          configObj.enter.tasksToRun = taskParser(etObj.value);
        }
        let xpeObj = formObj.find(o => { return (o.name === "xpeInput"); });
        if (xpeObj !== undefined) {
          if (!configObj.exit) configObj.exit = {};
          configObj.exit.profilesToEnable = profileParser(xpeObj.value);
        }
        let xpdObj = formObj.find(o => { return (o.name === "xpdInput"); });
        if (xpdObj !== undefined) {
          if (!configObj.exit) configObj.exit = {};
          configObj.exit.profilesToDisable = profileParser(xpdObj.value);
        }
        let xtObj = formObj.find(o => { return (o.name === "xtInput"); });
        if (xtObj !== undefined) {
          if (!configObj.exit) configObj.exit = {};
          configObj.exit.tasksToRun = taskParser(xtObj.value);
        }
        console.dir(configObj);
        CONFIG_NAME = formObj.find(o => { return (o.name === "nameInput"); }).value || "config";
        GENERATED_CONFIG = JSON.stringify(configObj, null, 2);
        $("#config-code").text(GENERATED_CONFIG);
        $("#download-button").attr('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(GENERATED_CONFIG));
        $("#download-button").attr('download', CONFIG_NAME + ".json");
        $("#code-modal").modal();
        return false;
      }

      var form = document.getElementById('config-form');
      if (form.attachEvent) {
        form.attachEvent("submit", processForm);
      } else {
        form.addEventListener("submit", processForm);
      }

      function profileParser(input) {
        return input.split(',')
                    .map(p => { return p.trim(); })
                    .filter(p => { return (p !== ''); });
      }

      function taskParser(input) {
        return input.split(',')
                    .map(t => {
                      let o = {};
                      let parts = t.split('|');
                      if (parts[0].trim() === '') return '';
                      o.name = parts[0].trim();
                      let priority = parts[1] || '10';
                      o.priority = parseInt(priority);
                      o.param1 = parts[2] || '';
                      o.param2 = parts[3] || '';
                      return o;
                    }).filter(t => { return (t !== ''); });
      }
    </script>
  </body>
</html>